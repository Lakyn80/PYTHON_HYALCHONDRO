{% extends "layout_admin.html" %} {% block title %}Objedn√°vky{% endblock %} {%
block content %}
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/orders_table.css') }}"
/>

<h2 class="text-center mb-4">üìã Objedn√°vky z√°kazn√≠k≈Ø</h2>

<!-- DataTables CSS -->
<link
  rel="stylesheet"
  href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css"
/>
<link
  rel="stylesheet"
  href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css"
/>

<!-- jQuery + DataTables JS -->
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>

<div class="orders-wrapper">
  <table
    id="orders-table"
    class="display nowrap admin-table"
    style="width: 100%"
  >
    <thead>
      <tr>
        <th>Faktura</th>
        <th>Objedn√°vka</th>
        <th>Jm√©no</th>
        <th>Email</th>
        <th>Adresa</th>
        <th>Produkt</th>
        <th>Mno≈æstv√≠</th>
        <th>Datum</th>
        <th>Stav</th>
      </tr>
    </thead>
    <tfoot>
      <tr>
        <th>Faktura</th>
        <th>Objedn√°vka</th>
        <th>Jm√©no</th>
        <th>Email</th>
        <th>Adresa</th>
        <th>Produkt</th>
        <th>Mno≈æstv√≠</th>
        <th>Datum</th>
        <th>Stav</th>
      </tr>
    </tfoot>
    <tbody>
      {% for order in orders %}
      <tr>
        <td>F{{ "%03d"|format(order.id) }}</td>
        <td>ORD{{ "%03d"|format(order.id) }}</td>
        <td>{{ order.name }}</td>
        <td>{{ order.email }}</td>
        <td>{{ order.address }}</td>
        <td>{{ order.product.name }}</td>
        <td>{{ order.quantity }}</td>
        <td>{{ order.created_at.strftime('%d.%m.%Y') }}</td>
        <td>
          <span class="badge badge-{{ order.status | lower }}">
            {{ order.status or "neuvedeno" }}
          </span>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<script>
  $(document).ready(function () {
    $("#orders-table tfoot th").each(function () {
      const title = $(this).text();
      $(this).html('<input type="text" placeholder="Filtr ' + title + '" />');
    });

    const table = $("#orders-table").DataTable({
      dom: "Bfrtip",
      buttons: ["copy", "csv", "excel", "pdf", "print"],
      responsive: true,
      language: {
        url: "//cdn.datatables.net/plug-ins/1.13.6/i18n/cs.json",
      },
      initComplete: function () {
        this.api()
          .columns()
          .every(function () {
            const that = this;
            $("input", this.footer()).on("keyup change", function () {
              if (that.search() !== this.value) {
                that.search(this.value).draw();
              }
            });
          });
      },
    });
  });
</script>

{% endblock %}
